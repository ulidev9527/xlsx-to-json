# xlsx-to-json
.xlsx 转 json



## 注意事项

1. **转换会将`类型转换为小写`**
2. **转换会取消所有数据的`空格/换行`,所有的空格和换行`无效`**
3. **符号相关的需要使用`英文输入状态的半角符号`**
4. **只接受`同时`执行`一个文件/文件夹`拖入**
5. **文件解析,会在相同目录下生成相同文件名`*/*.json`文件**
6. **文件夹解析时,会`在文件夹下面`生成`*/xlsx_to_json`文件夹**

## 使用
`qdw-tool --gcp `文件/文件夹路径

## 转换格式

类别 | 字段类型 | 默认参数 | xlsx数据格式 | json数据格式 | 备注说明
---|---|---|---|---|---
`字符串` |
- | string <br> String | `""` | 字符串 | "字符串" |
`数字` |
- | number <br> Number <br> int | `0` | 0 | 0 | 不能转换的值使用默认值
示例1: | | | 字符串 | 0 | 无法转换为数字,使用默认值
示例2: | | | "123" | 123 | 可以转换为数字,直接转换
示例3: | | | "1.2" | 1.2 | 浮点数,转换为浮点数
`数组` |
`默认数组` | array <br> Array | `[]` | a,1,3,f,哈哈 | ["a",1,3,"f","哈哈"] | 使用`,`逗号分割前后数据 <br> 可`转换为数字`,`优先进行数字转换`
`字符串数组` | strArray | `[]` |@@你好@@我是谁 | ["你好","我是谁"] | 使用:`@@`分割前后数据 <br> 按照`string`方式转换
`数字数组` | numArray | `[]` |a,1,3,f,哈哈 | [0,1,3,0,0] | 使用`,`逗号分割前后数据 <br> 按照`number`方式转换
`坐标 `| | | | | 1. 使用`,`逗号分割前后数据 <br> 2. 按`numArray`方式转换 <br> 3. 根据数组进行取值 <br> 4. 无值默认取:`0`
`自动坐标` | point | `{}` | x,y,z| {x:0,y:0,z:0}| 使用`,`逗号分割 
示例1 | | | | {} |  
示例2 | | | 100 | {x:100} | 
示例3 | | | 100,200 | {x:100,y:200} 
`3维坐标` | xyz | `{x:0,y:0,z:0}` | x,y,z | {x:0,y:0,z:0} | 只会有`xyz参数返回`
`2维坐标` | xy | `{x:0,y:0}` | x,y,z | {x:0,y:0} | 只会有`xy参数返回`

## 转换示例

`*.xlsx`

```
+─────────+────────────────────────+─────────+───────────────+
| 物品id    | 物品类型(1=货币 2=碎片 3=消耗品)  | 物品图标    | 物品描述          |
+─────────+────────────────────────+─────────+───────────────+
| id      | type                   | icon    | desc          |
| string  | number                 | string  | string        |
| 1000    | 1                      | money   | 金币,用于游戏中物品交易  |
| 1001    | 2                      | viking  | 维京碎片,用于合成维京   |
+─────────+────────────────────────+─────────+───────────────+
```

`*.json` 转换后
```json
[
    {
        "id":"1000",
        "type":1,
        "icon":"money",
        "desc":"金币,用于游戏中物品交易"
    }
    ...
]
```

## 转换说明

+ 前三行固定格式

    ```
    +────────────────────+
    | 字段描述               |
    +────────────────────+
    | 字段名(解析成json键名)     |
    | 字段类型(更加类型解析成不同的值)  |
    | 第一行数据              |
    | 第二行数据              |
    +────────────────────+
    ```

+ `字段描述/字段名/字段类型`都存在的情况下才会进行解析

    ```
    xlsx数据
    +─────────+──────────+─────────────+────────────────────────────────+
    | 角色id    | 角色基础攻击力  | 角色攻击力波动     | 角色实际攻击力算法                      |
    +─────────+──────────+─────────────+────────────────────────────────+
    | id      | atk      | atk_range  | 角色等级*${atk}+角色等级*${atk_range}  |
    | string  | number   | array       |                                |
    | 1000    | 100      | -10,10      |                                |
    |         |          |             |                                |
    +─────────+──────────+─────────────+────────────────────────────────+
    ```

    ```json
    json数据
    [{
        "id":"1000",
        "atk":100,
        "atk_range":[-10,10]
    }]
    ```
    
+ 没有对应解析器 默认解析为字符串